# Story 4.3: Due Date Notifications

## Status
Ready

## Story

**As a** user,  
**I want** visual indicators for tasks approaching their deadline,  
**so that** I can prioritize urgent work and avoid missing due dates.

## Acceptance Criteria

1. Tasks with deadline today show yellow warning indicator
2. Tasks with deadline in the past (overdue) show red warning indicator
3. Tasks marked as "done" don't show deadline warnings (already completed)
4. Visual indicators include icon (‚ö†Ô∏è or üî¥) and color coding
5. Tooltip or text explains the warning (e.g., "Due today!", "Overdue by 2 days")
6. Badge styling makes deadline status immediately visible
7. Warnings update automatically (based on current date comparison)

## Tasks / Subtasks

- [ ] Task 1: Create deadline status utility function (AC: 1, 2, 3, 7)
  - [ ] Create or update `frontend/src/lib/task-utils.ts`
  - [ ] Function `getDeadlineStatus(task: Task): 'overdue' | 'today' | 'upcoming' | 'ok'`
  - [ ] Logic:
    - If status === 'done': return 'ok'
    - If deadline < today: return 'overdue'
    - If deadline === today: return 'today'
    - Else: return 'ok'
  - [ ] Function `getDeadlineMessage(task: Task): string` for tooltip text

- [ ] Task 2: Add visual indicators to task cards (AC: 4, 5, 6)
  - [ ] Update `frontend/src/app/tasks/page.tsx`
  - [ ] Call getDeadlineStatus for each task
  - [ ] Display warning badge based on status:
    - overdue: Red badge with üî¥ "Overdue"
    - today: Yellow/orange badge with ‚ö†Ô∏è "Due today"
  - [ ] Position prominently on task card
  - [ ] Add tooltip or helper text

- [ ] Task 3: Manual testing
  - [ ] Create task with deadline today - verify yellow warning
  - [ ] Create task with past deadline - verify red overdue
  - [ ] Mark overdue task as done - verify warning disappears
  - [ ] Test with various deadline dates

## Dev Notes

### Deadline Status Logic

```typescript
export function getDeadlineStatus(task: Task): 'overdue' | 'today' | 'ok' {
  if (task.status === 'done') return 'ok';
  
  const today = new Date();
  today.setHours(0, 0, 0, 0);
  
  const deadline = new Date(task.deadline);
  deadline.setHours(0, 0, 0, 0);
  
  if (deadline < today) return 'overdue';
  if (deadline.getTime() === today.getTime()) return 'today';
  return 'ok';
}

export function getDeadlineMessage(task: Task): string {
  const status = getDeadlineStatus(task);
  
  if (status === 'overdue') {
    const today = new Date();
    const deadline = new Date(task.deadline);
    const daysOverdue = Math.floor((today.getTime() - deadline.getTime()) / (1000 * 60 * 60 * 24));
    return daysOverdue === 1 ? 'Overdue by 1 day' : `Overdue by ${daysOverdue} days`;
  }
  
  if (status === 'today') return 'Due today!';
  return '';
}
```

### Visual Indicators

```typescript
{getDeadlineStatus(task) === 'overdue' && (
  <Badge className="bg-red-100 text-red-800 dark:bg-red-900/30">
    üî¥ Overdue
  </Badge>
)}

{getDeadlineStatus(task) === 'today' && (
  <Badge className="bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30">
    ‚ö†Ô∏è Due today
  </Badge>
)}
```

### File Locations

Create:
- `frontend/src/lib/task-utils.ts`

Modify:
- `frontend/src/app/tasks/page.tsx`

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-30 | 1.0 | Story created for Epic 4 | Bob (SM) |

## Dev Agent Record
_To be populated by dev agent_

## QA Results
_To be populated by QA agent_

